# Test goal: First testing for bachelor thesis
# Author: Ronald Ch. Siddall

flow123d_version: 3.1.0
problem: !Coupling_Sequential
  description: 2D elastic model with a single fracture with different BC.
  mesh:
    mesh_file: /C/Plocha/Bachelor_thesis/Python_scripts/Analysis_displacement_sequences/example_healed.msh
  flow_equation: !Coupling_Iterative
    input_fields:
    time:
      end_time: 36

    flow_equation: !Flow_Darcy_LMH
      input_fields:
      - region: fractures
        cross_section: 0.01
      - region: .BOUNDARY
        bc_type: dirichlet
        bc_pressure: 0
      output:
        fields: []


    mechanics_equation:
      output_stream:
        file: mechanics.pvd
        format: !vtk
          variant: ascii
      output:
        times:
        - step: 1
        fields:
        - displacement
        - stress
        - cross_section_updated
        - region_id
      solver: !Petsc
      contact: true
      input_fields:
      - region: rock
        young_modulus: 50000
        poisson_ratio: 0

      - region: fractures
        young_modulus: 100.0
        poisson_ratio: 0
        cross_section_min: 0

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 1
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.11*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 1
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.11*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 2
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.11*y, 0.11*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 2
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.11*y, 0.11*x, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 3
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.09*x, 0, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 3
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.09*x, 0, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 4
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.09*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 4
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.09*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 5
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.09*y, 0.09*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 5
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.09*y, 0.09*x, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 6
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.07*x, 0, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 6
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.07*x, 0, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 7
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.07*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 7
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.07*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 8
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.07*y, 0.07*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 8
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.07*y, 0.07*x, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 9
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.05*x, 0, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 9
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.05*x, 0, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 10
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.05*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 10
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.05*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 11
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.05*y, 0.05*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 11
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.05*y, 0.05*x, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 12
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.03*x, 0, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 12
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.03*x, 0, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 13
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.03*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 13
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.03*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 14
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.03*y, 0.03*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 14
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.03*y, 0.03*x, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 15
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.01*x, 0, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 15
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.01*x, 0, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 16
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.01*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 16
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, 0.01*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 17
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.01*y, 0.01*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 17
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0.01*y, 0.01*x, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 18
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.01*x, 0, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 18
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.01*x, 0, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 19
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.01*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 19
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.01*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 20
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.01*y, -0.01*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 20
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.01*y, -0.01*x, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 21
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.03*x, 0, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 21
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.03*x, 0, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 22
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.03*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 22
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.03*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 23
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.05*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 23
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.05*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 23
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.03*y, -0.03*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 23
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.03*y, -0.03*x, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 24
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.05*x, 0, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 24
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.05*x, 0, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 26
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.07*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 26
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.07*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 26
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.05*y, -0.05*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 26
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.05*y, -0.05*x, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 27
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.07*x, 0, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 27
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.07*x, 0, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 29
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.09*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 29
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.09*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 29
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.07*y, -0.07*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 29
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.07*y, -0.07*x, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 30
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.09*x, 0, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 30
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.09*x, 0, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 32
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.11*y, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 32
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [0, -0.11*y, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 32
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.09*y, -0.09*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 32
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.09*y, -0.09*x, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 33
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.11*x, 0, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 33
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.11*x, 0, 0]

      - region: [.side_x0, .side_x1, .side_y0, .side_y1]
        time: 35
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.11*y, -0.11*x, 0]
      - region: [.side_x0_fractures, .side_x1_fractures, .side_y0_fractures, .side_y1_fractures]
        time: 35
        bc_type: displacement
        bc_displacement: !FieldFormula
          value: [-0.11*y, -0.11*x, 0]